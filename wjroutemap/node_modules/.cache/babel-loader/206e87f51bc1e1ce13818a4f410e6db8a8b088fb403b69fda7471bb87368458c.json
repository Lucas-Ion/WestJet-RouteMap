{"ast":null,"code":"import { vModelText as _vModelText, withKeys as _withKeys, createElementVNode as _createElementVNode, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"height\": \"1000px\",\n    \"width\": \"1300px\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"search-overlay\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_l_tile_layer = _resolveComponent(\"l-tile-layer\");\n  const _component_l_icon = _resolveComponent(\"l-icon\");\n  const _component_l_tooltip = _resolveComponent(\"l-tooltip\");\n  const _component_l_marker = _resolveComponent(\"l-marker\");\n  const _component_l_map = _resolveComponent(\"l-map\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_l_map, {\n    ref: \"map\",\n    zoom: $data.zoom,\n    center: $data.center,\n    maxZoom: \"7\",\n    minZoom: \"4\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      placeholder: \"Search\",\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.searchQuery = $event),\n      onKeyup: _cache[1] || (_cache[1] = _withKeys($event => $options.search($data.searchQuery, $props.dests), [\"enter\"]))\n    }, null, 544 /* HYDRATE_EVENTS, NEED_PATCH */), [[_vModelText, $data.searchQuery]])]), _createVNode(_component_l_tile_layer, {\n      url: \"https://tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey=9b2313ed32304004a51c1494aedf88db\",\n      \"layer-type\": \"base\",\n      name: \"OpenStreetMap\"\n    }), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.dests, (dest, index) => {\n      return _openBlock(), _createBlock(_component_l_marker, {\n        ref_for: true,\n        ref: \"markers\",\n        key: index,\n        \"lat-lng\": $options.latLng(dest.latitude, dest.longitude),\n        onClick: $event => $options.openPopup(dest, index)\n      }, {\n        default: _withCtx(() => [_createVNode(_component_l_icon, {\n          \"icon-size\": $data.iconSize,\n          \"icon-url\": $data.icon\n        }, null, 8 /* PROPS */, [\"icon-size\", \"icon-url\"]), _createVNode(_component_l_tooltip, null, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(dest.name) + \", \" + _toDisplayString(dest.countryName), 1 /* TEXT */)]),\n\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */)]),\n\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"lat-lng\", \"onClick\"]);\n    }), 128 /* KEYED_FRAGMENT */))]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"zoom\", \"center\"])]);\n}","map":{"version":3,"mappings":";;EACOA,KAAmC,EAAnC;IAAA;IAAA;EAAA;AAAmC;;EAE/BC,KAAK,EAAC;AAAgB;;;;;;;uBAF/BC,oBAWM,OAXNC,UAWM,GAVJC,aASQC;IATDC,GAAG,EAAC,KAAK;IAAEC,IAAI,EAAEC,UAAI;IAAGC,MAAM,EAAED,YAAM;IAAEE,OAAO,EAAC,GAAG;IAACC,OAAO,EAAC;;sBACjE,MAEM,CAFNC,oBAEM,OAFNC,UAEM,mBADJD,oBAAwG;MAAjGE,IAAI,EAAC,MAAM;MAACC,WAAW,EAAC,QAAQ;iEAAUP,iBAAW;MAAGQ,OAAK,gDAAQC,eAAM,CAACT,iBAAW,EAAEU,YAAK;mEAApDV,iBAAW,OAE9DJ,aAAgLe;MAAlKC,GAAG,EAAC,uGAAuG;MAAC,YAAU,EAAC,MAAM;MAACC,IAAI,EAAC;2BACjJnB,oBAGWoB,6BAHkDJ,YAAK,GAArBK,IAAI,EAAEC,KAAK;2BAAxDC,aAGWC;;QAHDpB,GAAG,EAAC,SAAS;QAAEqB,GAAG,EAAEH,KAAK;QAAkC,SAAO,EAAEP,eAAM,CAACM,IAAI,CAACK,QAAQ,EAAEL,IAAI,CAACM,SAAS;QAAIC,OAAK,YAAEb,kBAAS,CAACM,IAAI,EAAEC,KAAK;;0BAChJ,MAAwD,CAAxDpB,aAAwD2B;UAA/C,WAAS,EAAEvB,cAAQ;UAAG,UAAQ,EAAEA;4DACzCJ,aAA8D4B;4BAAlD,MAAe,mCAAZT,IAAI,CAACF,IAAI,IAAG,IAAE,oBAAEE,IAAI,CAACU,WAAW","names":["style","class","_createElementBlock","_hoisted_1","_createVNode","_component_l_map","ref","zoom","$data","center","maxZoom","minZoom","_createElementVNode","_hoisted_2","type","placeholder","onKeyup","$options","$props","_component_l_tile_layer","url","name","_Fragment","dest","index","_createBlock","_component_l_marker","key","latitude","longitude","onClick","_component_l_icon","_component_l_tooltip","countryName"],"sourceRoot":"","sources":["/Users/lucasion/Desktop/Capstone/WestJet-RouteMap/wjroutemap/src/components/DestMap.vue"],"sourcesContent":["<template>\n  <div style=\"height:1000px; width:1300px\">\n    <l-map ref=\"map\" :zoom=\"zoom\" :center=\"center\" maxZoom=\"7\" minZoom=\"4\">\n      <div class=\"search-overlay\">\n        <input type=\"text\" placeholder=\"Search\" v-model=\"searchQuery\" @keyup.enter=\"search(searchQuery, dests)\">\n      </div>\n      <l-tile-layer url=\"https://tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey=9b2313ed32304004a51c1494aedf88db\" layer-type=\"base\" name=\"OpenStreetMap\"></l-tile-layer>\n      <l-marker ref=\"markers\" :key=\"index\" v-for=\"(dest, index) in dests\" :lat-lng=\"latLng(dest.latitude, dest.longitude)\" @click=\"openPopup(dest, index)\">\n        <l-icon :icon-size=\"iconSize\" :icon-url=\"icon\"></l-icon>\n        <l-tooltip> {{ dest.name }}, {{dest.countryName}} </l-tooltip>\n      </l-marker>\n    </l-map>\n  </div>\n</template>\n  \n<script>\n  import a from 'leaflet';\n  import 'leaflet.markercluster';\n\n  const L = window['L'];\n\n  import {\n    LMap,\n    LTileLayer,\n    LMarker,\n    LIcon,\n    LTooltip\n  } from \"@vue-leaflet/vue-leaflet\";\n\n  \n  import westjet from '../assets/westjet.png';\n  export default {\n    name: 'DestMap',\n    props: {\n      dests: Array\n    },\n    components: {\n      LMap,\n      LTileLayer,\n      LMarker,\n      LIcon,\n      LTooltip,\n    },\n    data() {\n      return {\n        url: 'https://tile.thunderforest.com/atlas/{z}/{x}/{y}.png?apikey=9b2313ed32304004a51c1494aedf88db',\n        attribution: '&copy; <a target=\"_blank\" href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n        zoom: 4,\n        center: [47.313220, -1.319482], //default\n        markerLatLngBob: [47.313220, -17.319482],\n        icon: westjet,\n        iconSize: [40, 25],\n        searchQuery: '',\n      };\n    },\n    methods: {\n      latLng: function(lat, lng) {\n        return [lat, lng]\n      },\n      getLocation: function() {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition((position) => {\n            var latitude = position.coords.latitude;\n            var longitude = position.coords.longitude;\n            this.center = [latitude, longitude]\n          });\n        }\n      },\n      search(searchQuery, dests) {\n        for(var index in dests)\n        {\n          var search = searchQuery.toLowerCase()\n          var destination = dests[index].name.toLowerCase()\n          if(destination.includes(search)) // search centers at the first substring result\n          {\n            this.center = [dests[index].latitude, dests[index].longitude]\n            return;\n          }\n        }\n      },\n      openPopup: async function(dest, index) {\n        let marker = this.$refs.markers[index].leafletObject;\n        \n        const price = await this.getPrice(dest.code);\n\n        let popupContent = `You have selected ${dest.name}'s airport <br> Price: ${price}`;\n        marker.unbindPopup().bindPopup(popupContent).openPopup();\n\n      },\n      getPrice: async function (destination) {\n \n        let route = \"YYC\"+ destination\n\n        const axios = require('axios');\n\n        let price = \"\"\n\n        const params = new URLSearchParams();\n        params.append('o', 'YYC');\n        params.append('d', destination);\n        params.append('rangeStartOffset', '0');\n        params.append('rangeEndOffset', '60');\n\n        try{\n          const response = await axios.get('https://api.westjet.com/price-points/v1/retail', {\n            params: params,\n            headers: {\n              'accept': 'application/json'\n            }\n          });\n          price = response.data[route][0].price;\n        } catch(error) {\n          console.log(error);\n          price = \"No price available.\";\n        }\n\n        return price;\n      }\n    },\n    mounted() {\n      this.getLocation();\n\n      let markers = markerClusterGroup();\n      \n      let map = this.$refs.map.leafletObject;\n\n      for(let marker in (this.$refs.markers)) {\n        markers.addLayer(marker.leafletObject);\n      }\n\n      map.addLayer(markers);\n    }\n  };\n</script>\n  \n<style>\n  .leaflet-container {\n    border-radius: 25px;\n  }\n\n  .search-overlay {\n    position: absolute;\n    top: 0;\n    left: -100px;\n    width: 75%;\n    height: 12%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 999;\n  }\n\n  input[type=\"text\"] {\n    padding: 10px;\n    border-radius: 5px;\n    border: none;\n    outline: none;\n    font-size: 16px;\n    background-color: white;\n    width: 50%;\n  }\n\n</style>\n\n    \n    "]},"metadata":{},"sourceType":"module","externalDependencies":[]}